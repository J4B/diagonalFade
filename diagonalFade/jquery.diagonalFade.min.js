(function($){if($.support==undefined){$.support={opacity:!($.browser.msie)}}$.fn.diagonalFade=function(customOptions){var options=$.extend({},$.fn.diagonalFade.defaultOptions,customOptions);return this.each(function(){var $this=$(this);var cw=$this.width();var ch=$this.height();var w=$this.children(":first").width();var h=$this.children(":first").height();var m=parseInt(ch/h);var n=parseInt(cw/w);var a=new Array();var f=new Array();var b=0;for(var i=0;i<m;i++){a[i]=new Array(n);for(var j=0;j<n;j++){a[i][j]=b;b++}}switch(options.fade){case'in':var o=100;break;case'out':var o=0;break}if((options.fadeDirection_y=='top-bottom'&&options.fadeDirection_x=='left-right')||(options.fadeDirection_y=='bottom-top'&&options.fadeDirection_x=='right-left')){for(var i=0;i<m+n-1;i++){var z1=(i<n)?0:i-n+1;var z2=(i<m)?0:i-m+1;var group=new Array();for(var j=i-z2;j>=z1;j--){group.push(a[j][i-j])}f.push(group)}if(options.fadeDirection_y=='top-bottom'&&options.fadeDirection_x=='left-right'){b=-1;cascade($this,f,b,options.fadeDirection_x,options.fadeDirection_y,o)}else if(options.fadeDirection_y=='bottom-top'&&options.fadeDirection_x=='right-left'){b=f.length;cascade($this,f,b,options.fadeDirection_x,options.fadeDirection_y,o)}}else if((options.fadeDirection_y=='bottom-top'&&options.fadeDirection_x=='left-right')||(options.fadeDirection_y=='top-bottom'&&options.fadeDirection_x=='right-left')){for(var i=1-m;i<n;i++){var group=new Array();for(var j=0;j<m;j++){if((i+j)>=0&&(i+j)<n){group.push(a[j][i+j])}}f.push(group)}if(options.fadeDirection_y=='bottom-top'&&options.fadeDirection_x=='left-right'){b=-1;cascade($this,f,b,options.fadeDirection_x,options.fadeDirection_y,o)}else if(options.fadeDirection_y=='top-bottom'&&options.fadeDirection_x=='right-left'){b=f.length;cascade($this,f,b,options.fadeDirection_x,options.fadeDirection_y,o)}}});function cascade(_t,_f,_i,_c_x,_c_y,_c_o){var t=_t;var f=_f;var i=_i;var o=_c_o;var c_x=_c_x;var c_y=_c_y;var isTrigger=true;if((c_x=='left-right'&&c_y=='top-bottom')||(c_x=='left-right'&&c_y=='bottom-top')){i++;if(f[i]){for(var j=0;j<f[i].length;j++){var k=f[i][j]+1;t.children(":nth-child("+k+")").animate({opacity:o},options.time,function(){if(isTrigger){cascade(t,f,i,c_x,c_y,o);isTrigger=false}})}}else{if($.isFunction(options.complete))options.complete.apply(this)}}else if((c_x=='right-left'&&c_y=='top-bottom')||(c_x=='right-left'&&c_y=='bottom-top')){i--;if(i>=0){for(var j=0;j<f[i].length;j++){var k=f[i][j]+1;t.children(":nth-child("+k+")").animate({opacity:o},options.time,function(){if(isTrigger){cascade(t,f,i,c_x,c_y,o);isTrigger=false}})}}else{if($.isFunction(options.complete))options.complete.apply(this)}}}};$.fn.diagonalFade.defaultOptions={time:100,fadeDirection_x:'left-right',fadeDirection_y:'top-bottom',fade:'out',complete:null}})(jQuery);